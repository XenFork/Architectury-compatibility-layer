plugins {
    id 'java'
    id 'groovy'
    id 'java-gradle-plugin'
    id 'com.github.johnrengelman.shadow' version '8.1.1'
    id 'maven-publish'
}

group = 'io.github.xenfork'
version = '1.0-SNAPSHOT'

repositories {
    google()
    jcenter()
    mavenCentral()
}

dependencies {
    shadow(gradleApi())
    shadow(localGroovy())
    shadow('commons-io:commons-io:2.15.0')

//    shadow 'org.ow2.asm:asm:9.6'
//    shadow 'org.ow2.asm:asm-commons:9.6'
//    shadow 'org.ow2.asm:asm-analysis:9.6'
//    shadow 'org.ow2.asm:asm-util:9.6'
//    shadow 'org.ow2.asm:asm-tree:9.6'
//    shadow('com.android.tools.build:gradle:8.1.3') {
//        exclude group:'org.ow2.asm'
//    }
}

tasks.shadowJar {
    from("LICENSE")
}

gradlePlugin {
    plugins {
        create("acl") {
            id = "acl"
            implementationClass = "io.github.xenfork.acl.Main"
        }
    }
}

java {
    withSourcesJar()
}

tasks.shadowJar.configure {
    archiveClassifier.set("")
}

tasks.jar.configure {
    enabled = false
    dependsOn(tasks.shadowJar)
}

publishing {
    repositories {
        mavenLocal()
    }
}